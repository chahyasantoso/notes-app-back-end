Hapi server dengan database postgres

1. bikin aplikasi dalam bentuk plugin, bikin folder api, isinya 
    - index.js -> ini runner aplikasinya
      musti ada object dengan property register yang berupa function(server, option);
      fungsi ini nanti dijalankan ketika plugin di registrasikan di server
      - disini dibuat instance noteHandler  -> memanfaatkan service NoteService (ini tergantung implementasi pakai in memory/postgres)
                                            -> memanfaatkan validator Joi
      - routing juga dijalankan disini -> routing memanfaatkan noteHandler yang baru dibuat

2. untuk menghubungkan nodejs dengan postgres database pakai module postgres = npm install pg
3. untuk koneksi ke database pakai environment variable = npm install dotenv
   - bikin file .env isinya PGUSER, PGHOST, PGPASSWORD, PGDATABASE, PGPORT
     ini juga dimanfaatkan untuk server variable yang isinya HOST dan PORT
   - jadi ketika bikin koneksi const pool = new Pool(), maka koneksi akan membaca dari env variable tersebut secara otomatis.
   
4. bikin user dan database dari CLI postgres, tapi nanti create table dari module migrasi node-pg-migrate. 
   - bikin user baru (bukan root) 
      - masuk sebagai root user postgres = psql -U postgres
      - masukkan password pertama kali install postgres
      - CREATE USER developer WITH ENCRYPED PASSWORD 'supersecretpassword'
   - bikin database
      - CREATE DATABASE notesapp
   - berikan hak akses user ke databasenya
      - GRANT ALL PRIVILEGES ON DATABASE notesapp TO developer
      - GRANT ALL SCHEMA PUBLIC TO developer
   - bikin tabel dengan teknik migrasi (semua pakai js untuk bikin tabelnya)
      - npm install node-pg-migrate
      - di package.json tambahin runner baru "migrate": "node-pg-migrate"
      - jadi nanti jalankannya npm migrate <<perintah>> dimana perintahnya bisa 
          - create 'nama migrasi'
          - up
          - down
          - redo
      - untuk pertama kali bikin migrasinya yah. jadi jalankan npm migrate create "create table notes"
        nanti dia bikin file js baru di folder migration dengan nama xxxx-create-table-notes.js
        isinya adalah script yang nanti dijalankan kalo perintah up, down, redo diberikan
      - masuk ke file js migrasinya, edit filenya. 
        - untuk up diisi dengan perintah create table
        - untuk down diisi perintah drop table
      - jalankan migrasi dengan perintah: npm migrate up
        maka module node-pg-migrate akan dijalankan, dia akan otomatis konek ke database menggunakan environment
        variable yang sudah didefiniskan, kemudian menjalankan script bagian up (create table)

5. NoteService akan menggunakan koneksi database, maka di class nya bikin koneksi dulu, pakai pool
   const { Pool } = require('pg');
   di constructor class => this._pool = new Pool();
   - lakukan query dengan parameterized query
      - bikin object query dengan member text dan values: misal
        const query = {
          text:Â 'INSERT INTO notes VALUES($1, $2, $3, $4, $5, $6) RETURNING id',
          values: [id, title, body, tags, createdAt, updatedAt],
        };
      - jalankan querynya 
        const result = await this._pool.query(query);


  
